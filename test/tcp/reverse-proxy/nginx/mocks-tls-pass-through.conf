worker_processes  1;

#error_log  logs/error.log;
#error_log  logs/error.log  notice;
#error_log  logs/error.log  info;

#pid        logs/nginx.pid;


events {
    worker_connections  1024;
}

stream {
    upstream web_server {
        # Our web server, listening for SSL traffic
        # Note the web server will expect traffic
        # at this xip.io "domain", just for our
        # example here
        server 127.0.0.1:1080;
    }

    upstream token_server {
        # Our web server, listening for SSL traffic
        # Note the web server will expect traffic
        # at this xip.io "domain", just for our
        # example here
        server 127.0.0.1:2091;
    }

    server {
        listen 1443;
        server_name  storage.googleapis.com;
        proxy_pass web_server;
    }

    server {
        listen 1443;
        server_name  localhost;
        proxy_pass token_server;
    }
}